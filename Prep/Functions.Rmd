---
title: "Functions"
author: "Eric Archer"
date: "December 29, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = TRUE)
```

It is important to remember that every command in R is actually executing some sort of function. Sometimes it is obvious when you are executing a function, like:

```{r}
mean(1:5)
```

Other times, it may not be obvious. For example, how many functions are being executed in this line?

```{r}
1 + 5
```

The (simplest) answer is 2. The first is the function `+` which adds two numbers. The second is the function `print` which displays the result. So in the above, what we are really doing is:

```{r}
print(`+`(1, 5))
```

## Function Definition

The basic format for declaring a function actually uses a function called (wait for it...) `function`. I like to think of every function as having the following four components:

* **Name** - The name a user will use to call the function.
* **Arguments** - The input values a function needs to operate on.
* **Body** - The code that processes the arguments.
* **Return Value** - The output from the result of the processing in **Body**.

However, in any given function, depending on its purpose, one or more of the above items may be missing. A simple function that has all four components designed to calculate (x+y)^z^ may look like the following:

```{r}
addAndRaise <- function(x, y, z) {
  result <- x + y
  result <- result ^ z
  return(result)
}
```

In this function, the name is `addAndRaise`, and if we call it with the arguments `x = 2`, `y = 3`, and `z = 5`, it will return the value 3125 ((3 + 2) ^ 5) = 5^5):

```{r}
addAndRaise(x = 2, y = 3, z = 5)
```

### Name

A function's name should be short(ish), but also meaningful and easy to understand. This is an art and you should take the time to play with names until they fit. In particular pretend like you are a naive user who has no idea what the function does and you want to get most of that information from the name. Also pay attention to how other functions that your function will be working with are named. For example, if you have a function that reads a particular data file and formats it for use, but this is only one of several data files that will be read, it would be bad form to call that function `readData`. It might be better to call it something like, `readSalinityData`. Even better might be, `readAndFormatSalinityData`. However, it would be unnecessarily long and mean to users to call it something like, `readSalinityDataFromCSVFileAndRemoveMissingDataPoints`.

### Arguments

This is a set of all input values that the function needs to operate on. It is good programming practice to make them both as short and as long as necessary to be descriptive.  In general, names for arguments should also be short and descriptive. However, some argument names are frequently used, such as `x` for the first argument, and `y` for the second argument, especially in mathematically-based functions or for data for axes in plotting functions. **It is good practice to not refer to anything in the function body that is either not in the arguments, or is not created in the function body.**

### Body

This is the code that is the heart of the function. It operates on the arguments to perform an action or convert them into a return value. Curly braces (`{` and `}`) are used to denote the code that composes the body and belongs to the function. If the function only has one line for a body then the curly braces can be omitted. For example:

```{r}
addAndRaise.2 <- function(x, y, z) return((x + y) ^ z)
addAndRaise.2(x = 2, y = 3, z = 5)
```

### Return Value

A function can only return on object. The function called `return` is often used to denote what this object is as in the above examples. However, if there is no call to `return`, then **the result of the last line in a function is its return value**. For example, our `addAndRaise` function could be written as:

```{r}
addAndRaise.3 <- function(x, y, z) {
  result <- x + y
  result <- result ^ z
  result
}
addAndRaise.3(x = 2, y = 3, z = 5)
```

Because "**the result of the last line in a function is its return value**", we can remove the last line of the body and the assignment in the second line of the body, and simplify it to:

```{r}
addAndRaise.4 <- function(x, y, z) {
  result <- x + y
  result ^ z
}
addAndRaise.4(x = 2, y = 3, z = 5)
```

We can even take it a few steps further, make it a single line function, and remove the curly braces:

```{r}
addAndRaise.5 <- function(x, y, z) (x + y)^z
addAndRaise.5(x = 2, y = 3, z = 5)
```
  
How many lines and intermediate steps you put in a function is up to you, but there is a middle ground. In general, try to avoid too many intermediate assignments when they are obvious in a calculation or manipulation. However, also avoid long, nested, single-line calculations that are difficult to understand (and debug) at first glance. You should be able to easily look at the function and work out what it does. If possible, restricting a function or major chunks of the function to one screen page is usually best.